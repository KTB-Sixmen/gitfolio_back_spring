FROM amazoncorretto:17 AS runner

WORKDIR /member

ARG MEMBER_MYSQL_DB_HOST
ARG MEMBER_MYSQL_DB_PORT
ARG MEMBER_MYSQL_DB_NAME
ARG MEMBER_MYSQL_DB_USERNAME
ARG MEMBER_MYSQL_DB_PASSWORD
ARG MEMBER_MONGO_DB_USERNAME
ARG MEMBER_MONGO_DB_PORT
ARG MEMBER_MONGO_DB_DATABASE

ENV MEMBER_MYSQL_DB_HOST=${MEMBER_MYSQL_DB_HOST} \
    MEMBER_MYSQL_DB_PORT=${MEMBER_MYSQL_DB_PORT} \
    MEMBER_MYSQL_DB_NAME=${MEMBER_MYSQL_DB_NAME} \
    MEMBER_MYSQL_DB_USERNAME=${MEMBER_MYSQL_DB_USERNAME} \
    MEMBER_MYSQL_DB_PASSWORD=${MEMBER_MYSQL_DB_PASSWORD} \
    MEMBER_MONGO_DB_USERNAME=${MEMBER_MONGO_DB_USERNAME} \
    MEMBER_MONGO_DB_PORT=${MEMBER_MONGO_DB_PORT} \
    MEMBER_MONGO_DB_DATABASE=${MEMBER_MONGO_DB_DATABASE}

EXPOSE 8081

COPY --from=aida0/gitfolio_builder:test /gitfolio_back/build/.env .env
COPY --from=aida0/gitfolio_builder:test /gitfolio_back/build/*-member-*-SNAPSHOT.jar member.jar

CMD [ "java", "-jar", "member.jar" ]